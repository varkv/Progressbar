/*!
 * kkProgressbar 1.0
 * https://github.com/varkv/kkProgressbar.js
 * @license MIT licensed
 *
 * Copyright (C) 2015 A project by Korol Kirill infokorol@gmail.com
 */

!function(r){r.fn.kkProgressbar=function(e){var s=!1,a=null,n={textList:["Обрабатываем запрос","Размечаем границы","Ставим маркеры","Ищем карты","Вращаем землю","Запускаем спутник","Кормим единорога"],speed:15,closeDelay:1e3};n.$progressbar_container=this,r.extend(n,e),n.$progressbar_container.addClass("kkProgressbar");for(var o,t,i=2,p=-1,g=[],l=0;i>l;l++){var u={},b=r("<div/>").addClass("progressbar_item").appendTo(n.$progressbar_container);u.$progressbar=r("<div/>").addClass("progressbar").appendTo(b).progressbar({}),u.$progressLabel=r("<div/>").addClass("progress-label").appendTo(b),g.push(u)}var c=-1,d=function(){return-1==p?p=0:p++,p>=n.textList.length&&(p=0),n.textList[p]},f=function(){var r=t,e=100*n.speed/2;t=v(),("undefined"==typeof r||null==r)&&(t.$progressLabel.text(d()),r=$(),r.$progressbar.closest(".progressbar_item").hide());var s=r.$progressbar.closest(".progressbar_item");s.animate({margin:"-40px 0 0"},e,"swing",function(){r.$progressbar.progressbar("value",0),r.$progressLabel.text(d()),s.show(),s.css({margin:"0",height:0}),s.appendTo(n.$progressbar_container).animate({height:40,margin:"5px 0"},e)}),t.$progressbar.progressbar("value",0)},v=function(){return-1==c?c=0:c++,c>=g.length&&(c=0),g[c]},$=function(){var r=c-1;return 0>r&&(r=g.length-1),g[r]},h=function(){var r=t.$progressbar.progressbar("value")||0;100==r&&(f(),r=0),t.$progressbar.progressbar("value",r+1)},m=function(){n.$progressbar_container.slideDown("fast")},_=function(){n.$progressbar_container.slideUp("fast")},x=function(){_(),s=!1,t.$progressbar.progressbar("value",0),t=null,c=-1,"undefined"!=typeof o&&clearInterval(o)},L=function(){null!=a&&clearTimeout(a),s||(s=!0,f(),m(),o=setInterval(h,n.speed))},T=function(){s&&(s=!1,a=setTimeout(function(){x()},n.closeDelay))};return{enable:L,disable:T}}}(jQuery);